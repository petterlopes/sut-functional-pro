# Relatório de Vulnerabilidade RSA (RUSTSEC-2023-0071)

## Resumo da Vulnerabilidade

**ID**: RUSTSEC-2023-0071  
**Título**: Marvin Attack: potential key recovery through timing sidechannels  
**Severidade**: 5.9 (média)  
**Data**: 2023-11-22  
**Biblioteca Afetada**: `rsa` versão 0.9.8  

## Descrição da Vulnerabilidade

A vulnerabilidade RUSTSEC-2023-0071 refere-se a uma falha de segurança na biblioteca `rsa` do Rust que a torna suscetível a ataques de temporização (timing attacks). Um invasor pode potencialmente recuperar chaves privadas observando o tempo de execução de operações criptográficas.

## Impacto no Projeto SUT

### Dependência Transitiva
A vulnerabilidade está presente através da seguinte cadeia de dependências:
```
rsa 0.9.8
└── sqlx-mysql 0.8.6
    ├── sqlx-macros-core 0.8.6
    │   └── sqlx-macros 0.8.6
    │       └── sqlx 0.8.6
    │           └── sut-api 1.0.0
    └── sqlx 0.8.6
```

### Análise de Risco
- **Risco Real**: BAIXO - O projeto não utiliza MySQL, apenas PostgreSQL
- **Exposição**: A biblioteca `rsa` vulnerável está incluída mas não é utilizada ativamente
- **Impacto**: Potencial exposição a ataques de temporização se operações RSA fossem executadas

## Tentativas de Resolução

### 1. Desabilitação de Features Padrão
**Ação**: Adicionado `default-features = false` ao SQLx
```toml
sqlx = { version = "0.8.3", features = ["runtime-tokio-rustls", "postgres", "uuid", "chrono", "macros", "migrate"], default-features = false }
```
**Resultado**: ❌ Falhou - `sqlx-mysql` ainda é incluído via `sqlx-macros`

### 2. Atualização de Versão
**Ação**: Tentativa de atualizar para SQLx 0.8.3
**Resultado**: ❌ Falhou - Versão mais recente não resolve a dependência

### 3. Patch de Dependência
**Ação**: Tentativa de usar `[patch.crates-io]` para forçar versão segura do RSA
**Resultado**: ❌ Falhou - Conflitos de versão e incompatibilidades

### 4. Remoção de Features
**Ação**: Tentativa de remover feature `macros` do SQLx
**Resultado**: ❌ Falhou - Feature necessária para compilação

## Status Atual

### Vulnerabilidade Persistente
- ✅ **Compilação**: Projeto compila com sucesso
- ❌ **Vulnerabilidade**: RUSTSEC-2023-0071 ainda presente
- ⚠️ **Risco**: Baixo (dependência não utilizada)

### Configuração Atual
```toml
sqlx = { version = "0.8.3", features = ["runtime-tokio-rustls", "postgres", "uuid", "chrono", "macros", "migrate"], default-features = false }
```

## Recomendações

### Curto Prazo (Mitigação)
1. **Monitoramento**: Acompanhar atualizações do SQLx que resolvam a dependência
2. **Documentação**: Manter registro da vulnerabilidade para auditorias
3. **Testes**: Verificar se operações RSA são realmente executadas

### Médio Prazo (Resolução)
1. **Aguardar Atualização**: SQLx pode lançar versão que não inclua `sqlx-mysql` por padrão
2. **Alternativas**: Considerar migração para biblioteca ORM alternativa se necessário
3. **Fork**: Considerar fork do SQLx com remoção da dependência MySQL

### Longo Prazo (Prevenção)
1. **Auditoria Regular**: Implementar `cargo audit` no CI/CD
2. **Dependências Mínimas**: Manter dependências apenas do que é realmente necessário
3. **Monitoramento**: Configurar alertas para novas vulnerabilidades

## Conclusão

A vulnerabilidade RUSTSEC-2023-0071 está presente no projeto através de uma dependência transitiva não utilizada (`sqlx-mysql`). Embora o risco seja baixo, a vulnerabilidade persiste e deve ser monitorada. As tentativas de resolução imediata falharam devido à arquitetura de dependências do SQLx.

**Recomendação**: Manter o projeto em funcionamento enquanto monitora atualizações do SQLx que possam resolver esta dependência transitiva.

---
*Relatório gerado em: $(date)*  
*Versão do SQLx: 0.8.3*  
*Status: Vulnerabilidade persistente, risco baixo*
